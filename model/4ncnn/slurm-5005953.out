The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) modules/2.3-20240529   2) openblas/single-0.3.26
üöÄ Starting Run. All outputs will be saved to: training_outputs/20250717-235944
‚öôÔ∏è Using device: cuda
Hyperparameters: {'input_depth': 32, 'input_height': 32, 'input_width': 32, 'num_classes': 3, 'classes_names': ['mitotic', 'new_daughter', 'stable'], 'learning_rate': 0.0001, 'batch_size': 16, 'num_epochs': 300, 'num_input_channels': 3, 'dropout_rate': 0.5, 'weight_decay': 1e-05, 'early_stopping_patience': 25, 'max_samples_per_class': {'mitotic': 329, 'new_daughter': 329, 'stable': 329}, 'class_weights': [1.0, 1.0, 1.0]}

Loading datasets...
Dataset loaded with 987 total samples:
  - mitotic: 329 samples
  - new_daughter: 329 samples
  - stable: 329 samples
  Applied per-class limits:
    - mitotic: 329 max samples
    - new_daughter: 329 max samples
    - stable: 329 max samples
Dataset loaded with 987 total samples:
  - mitotic: 329 samples
  - new_daughter: 329 samples
  - stable: 329 samples
  Applied per-class limits:
    - mitotic: 329 max samples
    - new_daughter: 329 max samples
    - stable: 329 max samples

Training on 789 samples, validating on 198 samples.
Model has 70,947 trainable parameters.

--- Starting Training ---
Epoch [001/300] | Duration: 26.09s | Train Loss: 0.9690 | Train Acc: 0.5272 | Val Loss: 0.9918 | Val Acc: 0.4091 | Val F1: 0.3144
üéâ New best model found! F1-Score: 0.3144. Saved to training_outputs/20250717-235944/best_model.pth
Epoch [002/300] | Duration: 27.04s | Train Loss: 0.8199 | Train Acc: 0.6781 | Val Loss: 0.7262 | Val Acc: 0.6970 | Val F1: 0.6874
üéâ New best model found! F1-Score: 0.6874. Saved to training_outputs/20250717-235944/best_model.pth
Epoch [003/300] | Duration: 28.25s | Train Loss: 0.7536 | Train Acc: 0.7034 | Val Loss: 0.6784 | Val Acc: 0.7323 | Val F1: 0.7266
üéâ New best model found! F1-Score: 0.7266. Saved to training_outputs/20250717-235944/best_model.pth
Epoch [004/300] | Duration: 28.05s | Train Loss: 0.7151 | Train Acc: 0.7085 | Val Loss: 0.6470 | Val Acc: 0.7071 | Val F1: 0.6978
Epoch [005/300] | Duration: 27.91s | Train Loss: 0.6810 | Train Acc: 0.7338 | Val Loss: 0.6370 | Val Acc: 0.7374 | Val F1: 0.7337
üéâ New best model found! F1-Score: 0.7337. Saved to training_outputs/20250717-235944/best_model.pth
Epoch [006/300] | Duration: 30.69s | Train Loss: 0.6696 | Train Acc: 0.7389 | Val Loss: 0.6054 | Val Acc: 0.7576 | Val F1: 0.7551
üéâ New best model found! F1-Score: 0.7551. Saved to training_outputs/20250717-235944/best_model.pth
Epoch [007/300] | Duration: 36.52s | Train Loss: 0.6297 | Train Acc: 0.7478 | Val Loss: 0.5681 | Val Acc: 0.7929 | Val F1: 0.7924
üéâ New best model found! F1-Score: 0.7924. Saved to training_outputs/20250717-235944/best_model.pth
Epoch [008/300] | Duration: 80.46s | Train Loss: 0.6353 | Train Acc: 0.7693 | Val Loss: 0.5606 | Val Acc: 0.7929 | Val F1: 0.7876
Epoch [009/300] | Duration: 31.25s | Train Loss: 0.6174 | Train Acc: 0.7731 | Val Loss: 0.5506 | Val Acc: 0.7879 | Val F1: 0.7853
Epoch [010/300] | Duration: 29.60s | Train Loss: 0.6056 | Train Acc: 0.7693 | Val Loss: 0.5458 | Val Acc: 0.8030 | Val F1: 0.8024
üéâ New best model found! F1-Score: 0.8024. Saved to training_outputs/20250717-235944/best_model.pth
Epoch [011/300] | Duration: 29.67s | Train Loss: 0.5692 | Train Acc: 0.7947 | Val Loss: 0.4996 | Val Acc: 0.8283 | Val F1: 0.8275
üéâ New best model found! F1-Score: 0.8275. Saved to training_outputs/20250717-235944/best_model.pth
Epoch [012/300] | Duration: 30.48s | Train Loss: 0.5724 | Train Acc: 0.7934 | Val Loss: 0.5566 | Val Acc: 0.7929 | Val F1: 0.7915
Epoch [013/300] | Duration: 29.55s | Train Loss: 0.5571 | Train Acc: 0.8035 | Val Loss: 0.4885 | Val Acc: 0.8182 | Val F1: 0.8177
Epoch [014/300] | Duration: 29.90s | Train Loss: 0.5719 | Train Acc: 0.7934 | Val Loss: 0.4970 | Val Acc: 0.8232 | Val F1: 0.8231
Epoch [015/300] | Duration: 31.06s | Train Loss: 0.5207 | Train Acc: 0.8251 | Val Loss: 0.4972 | Val Acc: 0.8131 | Val F1: 0.8128
Epoch [016/300] | Duration: 32.25s | Train Loss: 0.5276 | Train Acc: 0.8137 | Val Loss: 0.5048 | Val Acc: 0.8131 | Val F1: 0.8106
Epoch [017/300] | Duration: 30.78s | Train Loss: 0.5211 | Train Acc: 0.8074 | Val Loss: 0.4663 | Val Acc: 0.8434 | Val F1: 0.8432
üéâ New best model found! F1-Score: 0.8432. Saved to training_outputs/20250717-235944/best_model.pth
Epoch [018/300] | Duration: 28.62s | Train Loss: 0.5141 | Train Acc: 0.8226 | Val Loss: 0.4675 | Val Acc: 0.8131 | Val F1: 0.8120
Epoch [019/300] | Duration: 27.31s | Train Loss: 0.5075 | Train Acc: 0.8099 | Val Loss: 0.4437 | Val Acc: 0.8333 | Val F1: 0.8331
Epoch [020/300] | Duration: 28.70s | Train Loss: 0.4903 | Train Acc: 0.8276 | Val Loss: 0.4497 | Val Acc: 0.8384 | Val F1: 0.8371
Epoch [021/300] | Duration: 28.71s | Train Loss: 0.5291 | Train Acc: 0.8061 | Val Loss: 0.4880 | Val Acc: 0.7980 | Val F1: 0.7974
Epoch [022/300] | Duration: 28.76s | Train Loss: 0.4986 | Train Acc: 0.8238 | Val Loss: 0.4397 | Val Acc: 0.8283 | Val F1: 0.8282
Epoch [023/300] | Duration: 29.17s | Train Loss: 0.4922 | Train Acc: 0.8099 | Val Loss: 0.4385 | Val Acc: 0.8586 | Val F1: 0.8575
üéâ New best model found! F1-Score: 0.8575. Saved to training_outputs/20250717-235944/best_model.pth
Epoch [024/300] | Duration: 29.09s | Train Loss: 0.4796 | Train Acc: 0.8365 | Val Loss: 0.4365 | Val Acc: 0.8384 | Val F1: 0.8373
Epoch [025/300] | Duration: 29.83s | Train Loss: 0.4574 | Train Acc: 0.8416 | Val Loss: 0.4296 | Val Acc: 0.8333 | Val F1: 0.8329
Epoch [026/300] | Duration: 30.22s | Train Loss: 0.4767 | Train Acc: 0.8352 | Val Loss: 0.4198 | Val Acc: 0.8485 | Val F1: 0.8489
Epoch [027/300] | Duration: 31.38s | Train Loss: 0.4683 | Train Acc: 0.8441 | Val Loss: 0.4514 | Val Acc: 0.8232 | Val F1: 0.8219
Epoch [028/300] | Duration: 29.61s | Train Loss: 0.4673 | Train Acc: 0.8314 | Val Loss: 0.4409 | Val Acc: 0.8384 | Val F1: 0.8374
Epoch [029/300] | Duration: 28.88s | Train Loss: 0.4625 | Train Acc: 0.8352 | Val Loss: 0.4421 | Val Acc: 0.8485 | Val F1: 0.8482
Epoch [030/300] | Duration: 28.09s | Train Loss: 0.4469 | Train Acc: 0.8631 | Val Loss: 0.4353 | Val Acc: 0.8283 | Val F1: 0.8278
Epoch [031/300] | Duration: 29.15s | Train Loss: 0.4414 | Train Acc: 0.8327 | Val Loss: 0.4530 | Val Acc: 0.8232 | Val F1: 0.8216
Epoch [032/300] | Duration: 27.77s | Train Loss: 0.4714 | Train Acc: 0.8251 | Val Loss: 0.4578 | Val Acc: 0.8333 | Val F1: 0.8325
Epoch [033/300] | Duration: 28.33s | Train Loss: 0.4451 | Train Acc: 0.8466 | Val Loss: 0.4527 | Val Acc: 0.8131 | Val F1: 0.8128
Epoch [034/300] | Duration: 29.45s | Train Loss: 0.4325 | Train Acc: 0.8441 | Val Loss: 0.4048 | Val Acc: 0.8485 | Val F1: 0.8489
Epoch [035/300] | Duration: 29.50s | Train Loss: 0.4527 | Train Acc: 0.8302 | Val Loss: 0.4157 | Val Acc: 0.8131 | Val F1: 0.8129
Epoch [036/300] | Duration: 27.22s | Train Loss: 0.4434 | Train Acc: 0.8454 | Val Loss: 0.4149 | Val Acc: 0.8485 | Val F1: 0.8487
Epoch [037/300] | Duration: 28.59s | Train Loss: 0.4675 | Train Acc: 0.8213 | Val Loss: 0.4072 | Val Acc: 0.8485 | Val F1: 0.8482
Epoch [038/300] | Duration: 29.41s | Train Loss: 0.4234 | Train Acc: 0.8555 | Val Loss: 0.4014 | Val Acc: 0.8535 | Val F1: 0.8527
Epoch [039/300] | Duration: 30.55s | Train Loss: 0.4020 | Train Acc: 0.8542 | Val Loss: 0.4020 | Val Acc: 0.8434 | Val F1: 0.8430
Epoch [040/300] | Duration: 29.03s | Train Loss: 0.4254 | Train Acc: 0.8492 | Val Loss: 0.4095 | Val Acc: 0.8586 | Val F1: 0.8590
üéâ New best model found! F1-Score: 0.8590. Saved to training_outputs/20250717-235944/best_model.pth
Epoch [041/300] | Duration: 28.31s | Train Loss: 0.4238 | Train Acc: 0.8340 | Val Loss: 0.4031 | Val Acc: 0.8636 | Val F1: 0.8635
üéâ New best model found! F1-Score: 0.8635. Saved to training_outputs/20250717-235944/best_model.pth
Epoch [042/300] | Duration: 30.07s | Train Loss: 0.4379 | Train Acc: 0.8428 | Val Loss: 0.4058 | Val Acc: 0.8535 | Val F1: 0.8534
Epoch [043/300] | Duration: 27.89s | Train Loss: 0.3842 | Train Acc: 0.8644 | Val Loss: 0.3994 | Val Acc: 0.8535 | Val F1: 0.8538
Epoch [044/300] | Duration: 26.90s | Train Loss: 0.4029 | Train Acc: 0.8568 | Val Loss: 0.3923 | Val Acc: 0.8535 | Val F1: 0.8536
Epoch [045/300] | Duration: 27.69s | Train Loss: 0.4178 | Train Acc: 0.8504 | Val Loss: 0.3908 | Val Acc: 0.8687 | Val F1: 0.8688
üéâ New best model found! F1-Score: 0.8688. Saved to training_outputs/20250717-235944/best_model.pth
Epoch [046/300] | Duration: 27.33s | Train Loss: 0.3823 | Train Acc: 0.8669 | Val Loss: 0.4045 | Val Acc: 0.8485 | Val F1: 0.8478
Epoch [047/300] | Duration: 27.85s | Train Loss: 0.4135 | Train Acc: 0.8657 | Val Loss: 0.3866 | Val Acc: 0.8586 | Val F1: 0.8591
Epoch [048/300] | Duration: 27.32s | Train Loss: 0.3953 | Train Acc: 0.8606 | Val Loss: 0.4213 | Val Acc: 0.8333 | Val F1: 0.8340
Epoch [049/300] | Duration: 29.82s | Train Loss: 0.3858 | Train Acc: 0.8580 | Val Loss: 0.4129 | Val Acc: 0.8384 | Val F1: 0.8380
Epoch [050/300] | Duration: 30.65s | Train Loss: 0.4034 | Train Acc: 0.8428 | Val Loss: 0.3792 | Val Acc: 0.8586 | Val F1: 0.8588
Epoch [051/300] | Duration: 28.01s | Train Loss: 0.3669 | Train Acc: 0.8758 | Val Loss: 0.3980 | Val Acc: 0.8586 | Val F1: 0.8584
Epoch [052/300] | Duration: 29.92s | Train Loss: 0.3879 | Train Acc: 0.8517 | Val Loss: 0.3928 | Val Acc: 0.8485 | Val F1: 0.8479
Epoch [053/300] | Duration: 29.97s | Train Loss: 0.3993 | Train Acc: 0.8593 | Val Loss: 0.4215 | Val Acc: 0.8485 | Val F1: 0.8473
Epoch [054/300] | Duration: 25.90s | Train Loss: 0.3725 | Train Acc: 0.8657 | Val Loss: 0.3971 | Val Acc: 0.8636 | Val F1: 0.8638
Epoch [055/300] | Duration: 30.69s | Train Loss: 0.3740 | Train Acc: 0.8593 | Val Loss: 0.4377 | Val Acc: 0.8182 | Val F1: 0.8178
Epoch [056/300] | Duration: 29.03s | Train Loss: 0.4033 | Train Acc: 0.8657 | Val Loss: 0.4241 | Val Acc: 0.8283 | Val F1: 0.8291
Epoch [057/300] | Duration: 31.52s | Train Loss: 0.4017 | Train Acc: 0.8568 | Val Loss: 0.4060 | Val Acc: 0.8434 | Val F1: 0.8432
Epoch [058/300] | Duration: 31.54s | Train Loss: 0.3984 | Train Acc: 0.8504 | Val Loss: 0.4344 | Val Acc: 0.8384 | Val F1: 0.8382
Epoch [059/300] | Duration: 29.98s | Train Loss: 0.3727 | Train Acc: 0.8682 | Val Loss: 0.4064 | Val Acc: 0.8434 | Val F1: 0.8436
Epoch [060/300] | Duration: 28.86s | Train Loss: 0.3694 | Train Acc: 0.8720 | Val Loss: 0.4245 | Val Acc: 0.8434 | Val F1: 0.8434
Epoch [061/300] | Duration: 27.71s | Train Loss: 0.3527 | Train Acc: 0.8745 | Val Loss: 0.3842 | Val Acc: 0.8788 | Val F1: 0.8789
üéâ New best model found! F1-Score: 0.8789. Saved to training_outputs/20250717-235944/best_model.pth
Epoch [062/300] | Duration: 28.42s | Train Loss: 0.3448 | Train Acc: 0.8821 | Val Loss: 0.3811 | Val Acc: 0.8586 | Val F1: 0.8591
Epoch [063/300] | Duration: 31.94s | Train Loss: 0.3391 | Train Acc: 0.8745 | Val Loss: 0.3846 | Val Acc: 0.8485 | Val F1: 0.8487
Epoch [064/300] | Duration: 32.99s | Train Loss: 0.3373 | Train Acc: 0.8885 | Val Loss: 0.3837 | Val Acc: 0.8535 | Val F1: 0.8533
Epoch [065/300] | Duration: 29.82s | Train Loss: 0.3510 | Train Acc: 0.8517 | Val Loss: 0.3903 | Val Acc: 0.8485 | Val F1: 0.8488
Epoch [066/300] | Duration: 29.10s | Train Loss: 0.3511 | Train Acc: 0.8720 | Val Loss: 0.3823 | Val Acc: 0.8687 | Val F1: 0.8687
Epoch [067/300] | Duration: 28.95s | Train Loss: 0.3546 | Train Acc: 0.8733 | Val Loss: 0.3885 | Val Acc: 0.8586 | Val F1: 0.8588
Epoch [068/300] | Duration: 28.20s | Train Loss: 0.3369 | Train Acc: 0.8733 | Val Loss: 0.3797 | Val Acc: 0.8586 | Val F1: 0.8585
Epoch [069/300] | Duration: 27.77s | Train Loss: 0.3422 | Train Acc: 0.8707 | Val Loss: 0.3864 | Val Acc: 0.8687 | Val F1: 0.8687
Epoch [070/300] | Duration: 26.60s | Train Loss: 0.3503 | Train Acc: 0.8771 | Val Loss: 0.3824 | Val Acc: 0.8586 | Val F1: 0.8588
Epoch [071/300] | Duration: 28.73s | Train Loss: 0.3442 | Train Acc: 0.8682 | Val Loss: 0.3787 | Val Acc: 0.8636 | Val F1: 0.8637
Epoch [072/300] | Duration: 27.34s | Train Loss: 0.3396 | Train Acc: 0.8720 | Val Loss: 0.3793 | Val Acc: 0.8636 | Val F1: 0.8638
Epoch [073/300] | Duration: 27.80s | Train Loss: 0.3345 | Train Acc: 0.8834 | Val Loss: 0.3920 | Val Acc: 0.8384 | Val F1: 0.8387
Epoch [074/300] | Duration: 27.77s | Train Loss: 0.3430 | Train Acc: 0.8821 | Val Loss: 0.3855 | Val Acc: 0.8535 | Val F1: 0.8538
Epoch [075/300] | Duration: 27.83s | Train Loss: 0.3679 | Train Acc: 0.8682 | Val Loss: 0.3814 | Val Acc: 0.8636 | Val F1: 0.8637
Epoch [076/300] | Duration: 29.92s | Train Loss: 0.3433 | Train Acc: 0.8745 | Val Loss: 0.3886 | Val Acc: 0.8485 | Val F1: 0.8491
Epoch [077/300] | Duration: 30.84s | Train Loss: 0.3543 | Train Acc: 0.8771 | Val Loss: 0.3795 | Val Acc: 0.8535 | Val F1: 0.8537
Epoch [078/300] | Duration: 30.80s | Train Loss: 0.3405 | Train Acc: 0.8695 | Val Loss: 0.3827 | Val Acc: 0.8535 | Val F1: 0.8538
Epoch [079/300] | Duration: 29.94s | Train Loss: 0.3308 | Train Acc: 0.8859 | Val Loss: 0.3906 | Val Acc: 0.8485 | Val F1: 0.8487
Epoch [080/300] | Duration: 28.40s | Train Loss: 0.3722 | Train Acc: 0.8644 | Val Loss: 0.3738 | Val Acc: 0.8636 | Val F1: 0.8638
Epoch [081/300] | Duration: 34.44s | Train Loss: 0.3434 | Train Acc: 0.8771 | Val Loss: 0.3884 | Val Acc: 0.8535 | Val F1: 0.8538
Epoch [082/300] | Duration: 23.59s | Train Loss: 0.3290 | Train Acc: 0.8847 | Val Loss: 0.3875 | Val Acc: 0.8636 | Val F1: 0.8635
Epoch [083/300] | Duration: 25.38s | Train Loss: 0.3440 | Train Acc: 0.8783 | Val Loss: 0.3816 | Val Acc: 0.8636 | Val F1: 0.8637
Epoch [084/300] | Duration: 23.81s | Train Loss: 0.3235 | Train Acc: 0.8885 | Val Loss: 0.3903 | Val Acc: 0.8636 | Val F1: 0.8636
Epoch [085/300] | Duration: 22.64s | Train Loss: 0.3260 | Train Acc: 0.8834 | Val Loss: 0.3928 | Val Acc: 0.8535 | Val F1: 0.8534
Epoch [086/300] | Duration: 27.91s | Train Loss: 0.3153 | Train Acc: 0.8948 | Val Loss: 0.3953 | Val Acc: 0.8485 | Val F1: 0.8488

üõë Early stopping triggered after 25 epochs with no improvement.

‚úÖ Training finished.

üíæ Saving final artifacts...
Loaded best model from training_outputs/20250717-235944/best_model.pth for final evaluation.
üìà Saved training metrics plot to training_outputs/20250717-235944/training_metrics.png
üìä Saved final confusion matrix to training_outputs/20250717-235944/final_confusion_matrix.png
üìù Saved final classification report to training_outputs/20250717-235944/final_classification_report.txt

‚ú® Run complete.
