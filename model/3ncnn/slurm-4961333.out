The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) modules/2.3-20240529   2) openblas/single-0.3.26
üöÄ Starting Run. All outputs will be saved to: training_outputs/20250708-135908
‚öôÔ∏è Using device: cuda
Hyperparameters: {'input_depth': 64, 'input_height': 64, 'input_width': 64, 'num_classes': 4, 'learning_rate': 1e-05, 'batch_size': 32, 'num_epochs': 300, 'num_input_channels': 3, 'patience': 50, 'max_samples_per_class': 2000, 'preserve_minority_classes': [0, 3], 'random_seed': 42, 'use_gpu_augmentation': True}

üìä Original class distribution:
  mitotic: 213 samples
  new_daughter: 433 samples
  stable: 20,915 samples
  death: 24 samples
  ‚úÖ mitotic: Preserving all 213 samples (minority class)
  ‚úÖ new_daughter: Keeping all 433 samples (under limit)
  üìâ stable: Limited from 20,915 to 2,000 samples
  ‚úÖ death: Preserving all 24 samples (minority class)

üìä Final balanced class distribution:
  mitotic: 213 samples (8.0%)
  new_daughter: 433 samples (16.2%)
  stable: 2,000 samples (74.9%)
  death: 24 samples (0.9%)

üéØ Total samples reduced from 21,585 to 2,670 (12.4% of original)

‚úÖ Dataset ready with 2670 balanced samples.
Class distribution: [ 213  433 2000   24]
Class weights: [ 3.13380282  1.54157044  0.33375    27.8125    ]

Loading datasets...
üöÄ Using GPU-accelerated augmentation (applied in training loop)

üìä Original class distribution:
  mitotic: 213 samples
  new_daughter: 433 samples
  stable: 20,915 samples
  death: 24 samples
  ‚úÖ mitotic: Preserving all 213 samples (minority class)
  ‚úÖ new_daughter: Keeping all 433 samples (under limit)
  üìâ stable: Limited from 20,915 to 2,000 samples
  ‚úÖ death: Preserving all 24 samples (minority class)

üìä Final balanced class distribution:
  mitotic: 213 samples (8.0%)
  new_daughter: 433 samples (16.2%)
  stable: 2,000 samples (74.9%)
  death: 24 samples (0.9%)

üéØ Total samples reduced from 21,585 to 2,670 (12.4% of original)

‚úÖ Dataset ready with 2670 balanced samples.

üìä Original class distribution:
  mitotic: 213 samples
  new_daughter: 433 samples
  stable: 20,915 samples
  death: 24 samples
  ‚úÖ mitotic: Preserving all 213 samples (minority class)
  ‚úÖ new_daughter: Keeping all 433 samples (under limit)
  üìâ stable: Limited from 20,915 to 2,000 samples
  ‚úÖ death: Preserving all 24 samples (minority class)

üìä Final balanced class distribution:
  mitotic: 213 samples (8.0%)
  new_daughter: 433 samples (16.2%)
  stable: 2,000 samples (74.9%)
  death: 24 samples (0.9%)

üéØ Total samples reduced from 21,585 to 2,670 (12.4% of original)

‚úÖ Dataset ready with 2670 balanced samples.

Training on 2136 samples, validating on 534 samples.
Model has 71,012 trainable parameters.

--- Starting Training ---
Epoch [001/300] | Duration: 182.24s | Train Loss: 1.3344 | Train Acc: 0.4902 | Val Loss: 1.3772 | Val Acc: 0.0787 | Val F1: 0.0365
üéâ New best model found! F1-Score: 0.0365. Saved to training_outputs/20250708-135908/best_model.pth
Epoch [002/300] | Duration: 152.79s | Train Loss: 1.2307 | Train Acc: 0.6905 | Val Loss: 1.3394 | Val Acc: 0.7434 | Val F1: 0.3488
üéâ New best model found! F1-Score: 0.3488. Saved to training_outputs/20250708-135908/best_model.pth
Epoch [003/300] | Duration: 133.84s | Train Loss: 1.1985 | Train Acc: 0.7060 | Val Loss: 1.3288 | Val Acc: 0.7079 | Val F1: 0.3378
Epoch [004/300] | Duration: 133.03s | Train Loss: 1.1969 | Train Acc: 0.7074 | Val Loss: 1.3175 | Val Acc: 0.7154 | Val F1: 0.3426
Epoch [005/300] | Duration: 133.36s | Train Loss: 1.1608 | Train Acc: 0.7004 | Val Loss: 1.3070 | Val Acc: 0.7116 | Val F1: 0.3433
Epoch [006/300] | Duration: 143.83s | Train Loss: 1.1610 | Train Acc: 0.6948 | Val Loss: 1.2951 | Val Acc: 0.7154 | Val F1: 0.3457
Epoch [007/300] | Duration: 140.78s | Train Loss: 1.1431 | Train Acc: 0.7013 | Val Loss: 1.2885 | Val Acc: 0.7022 | Val F1: 0.3397
Epoch [008/300] | Duration: 141.91s | Train Loss: 1.1502 | Train Acc: 0.6849 | Val Loss: 1.2780 | Val Acc: 0.7022 | Val F1: 0.3397
Epoch [009/300] | Duration: 139.97s | Train Loss: 1.1396 | Train Acc: 0.6882 | Val Loss: 1.2705 | Val Acc: 0.7041 | Val F1: 0.3410
Epoch [010/300] | Duration: 134.01s | Train Loss: 1.1309 | Train Acc: 0.6788 | Val Loss: 1.2636 | Val Acc: 0.6985 | Val F1: 0.3383
Epoch [011/300] | Duration: 130.93s | Train Loss: 1.1352 | Train Acc: 0.6756 | Val Loss: 1.2545 | Val Acc: 0.7097 | Val F1: 0.3434
Epoch [012/300] | Duration: 135.59s | Train Loss: 1.1160 | Train Acc: 0.6784 | Val Loss: 1.2446 | Val Acc: 0.7228 | Val F1: 0.3494
üéâ New best model found! F1-Score: 0.3494. Saved to training_outputs/20250708-135908/best_model.pth
Epoch [013/300] | Duration: 137.06s | Train Loss: 1.0705 | Train Acc: 0.6840 | Val Loss: 1.2382 | Val Acc: 0.7191 | Val F1: 0.3464
Epoch [014/300] | Duration: 135.61s | Train Loss: 1.0988 | Train Acc: 0.6812 | Val Loss: 1.2278 | Val Acc: 0.7172 | Val F1: 0.3462
Epoch [015/300] | Duration: 129.10s | Train Loss: 1.0648 | Train Acc: 0.6774 | Val Loss: 1.2193 | Val Acc: 0.7285 | Val F1: 0.3510
üéâ New best model found! F1-Score: 0.3510. Saved to training_outputs/20250708-135908/best_model.pth
Epoch [016/300] | Duration: 130.55s | Train Loss: 1.0803 | Train Acc: 0.6905 | Val Loss: 1.2140 | Val Acc: 0.7041 | Val F1: 0.3398
Epoch [017/300] | Duration: 135.71s | Train Loss: 1.0489 | Train Acc: 0.6980 | Val Loss: 1.2078 | Val Acc: 0.7060 | Val F1: 0.3401
Epoch [018/300] | Duration: 167.54s | Train Loss: 1.0506 | Train Acc: 0.6976 | Val Loss: 1.1994 | Val Acc: 0.7154 | Val F1: 0.3444
Epoch [019/300] | Duration: 162.11s | Train Loss: 1.0157 | Train Acc: 0.7079 | Val Loss: 1.1917 | Val Acc: 0.7322 | Val F1: 0.3527
üéâ New best model found! F1-Score: 0.3527. Saved to training_outputs/20250708-135908/best_model.pth
Epoch [020/300] | Duration: 152.77s | Train Loss: 1.0727 | Train Acc: 0.7032 | Val Loss: 1.1822 | Val Acc: 0.7303 | Val F1: 0.3519
Epoch [021/300] | Duration: 130.16s | Train Loss: 1.0366 | Train Acc: 0.7135 | Val Loss: 1.1798 | Val Acc: 0.7285 | Val F1: 0.3508
Epoch [022/300] | Duration: 126.79s | Train Loss: 1.0273 | Train Acc: 0.7158 | Val Loss: 1.1762 | Val Acc: 0.7191 | Val F1: 0.3461
Epoch [023/300] | Duration: 137.32s | Train Loss: 1.0364 | Train Acc: 0.7172 | Val Loss: 1.1699 | Val Acc: 0.7491 | Val F1: 0.3610
üéâ New best model found! F1-Score: 0.3610. Saved to training_outputs/20250708-135908/best_model.pth
Epoch [024/300] | Duration: 135.79s | Train Loss: 1.0146 | Train Acc: 0.7228 | Val Loss: 1.1636 | Val Acc: 0.7341 | Val F1: 0.3534
Epoch [025/300] | Duration: 135.22s | Train Loss: 0.9945 | Train Acc: 0.7200 | Val Loss: 1.1631 | Val Acc: 0.7266 | Val F1: 0.3497
Epoch [026/300] | Duration: 138.06s | Train Loss: 1.0105 | Train Acc: 0.7154 | Val Loss: 1.1590 | Val Acc: 0.7266 | Val F1: 0.3497
Epoch [027/300] | Duration: 133.78s | Train Loss: 0.9990 | Train Acc: 0.7383 | Val Loss: 1.1590 | Val Acc: 0.7266 | Val F1: 0.3499
Epoch [028/300] | Duration: 137.41s | Train Loss: 0.9891 | Train Acc: 0.7294 | Val Loss: 1.1566 | Val Acc: 0.7285 | Val F1: 0.3512
Epoch [029/300] | Duration: 138.71s | Train Loss: 0.9760 | Train Acc: 0.7271 | Val Loss: 1.1490 | Val Acc: 0.7472 | Val F1: 0.3599
Epoch [030/300] | Duration: 138.65s | Train Loss: 0.9946 | Train Acc: 0.7350 | Val Loss: 1.1494 | Val Acc: 0.7434 | Val F1: 0.3581
Epoch [031/300] | Duration: 128.70s | Train Loss: 0.9915 | Train Acc: 0.7458 | Val Loss: 1.1518 | Val Acc: 0.7603 | Val F1: 0.3668
üéâ New best model found! F1-Score: 0.3668. Saved to training_outputs/20250708-135908/best_model.pth
Epoch [032/300] | Duration: 125.73s | Train Loss: 1.0055 | Train Acc: 0.7537 | Val Loss: 1.1458 | Val Acc: 0.7266 | Val F1: 0.3504
Epoch [033/300] | Duration: 129.22s | Train Loss: 0.9660 | Train Acc: 0.7430 | Val Loss: 1.1416 | Val Acc: 0.7397 | Val F1: 0.3561
Epoch [034/300] | Duration: 125.63s | Train Loss: 0.9751 | Train Acc: 0.7406 | Val Loss: 1.1380 | Val Acc: 0.7828 | Val F1: 0.3791
üéâ New best model found! F1-Score: 0.3791. Saved to training_outputs/20250708-135908/best_model.pth
Epoch [035/300] | Duration: 132.93s | Train Loss: 0.9788 | Train Acc: 0.7360 | Val Loss: 1.1321 | Val Acc: 0.7622 | Val F1: 0.3674
Epoch [036/300] | Duration: 131.47s | Train Loss: 0.9957 | Train Acc: 0.7360 | Val Loss: 1.1334 | Val Acc: 0.7622 | Val F1: 0.3674
Epoch [037/300] | Duration: 116.71s | Train Loss: 1.0091 | Train Acc: 0.7467 | Val Loss: 1.1330 | Val Acc: 0.7434 | Val F1: 0.3579
Epoch [038/300] | Duration: 120.15s | Train Loss: 0.9840 | Train Acc: 0.7500 | Val Loss: 1.1349 | Val Acc: 0.7472 | Val F1: 0.3603
Epoch [039/300] | Duration: 125.87s | Train Loss: 0.9919 | Train Acc: 0.7453 | Val Loss: 1.1277 | Val Acc: 0.7809 | Val F1: 0.3781
Epoch [040/300] | Duration: 129.00s | Train Loss: 0.9436 | Train Acc: 0.7491 | Val Loss: 1.1258 | Val Acc: 0.7753 | Val F1: 0.3749
Epoch [041/300] | Duration: 127.43s | Train Loss: 0.9758 | Train Acc: 0.7523 | Val Loss: 1.1280 | Val Acc: 0.7547 | Val F1: 0.3637
Epoch [042/300] | Duration: 125.00s | Train Loss: 0.9658 | Train Acc: 0.7551 | Val Loss: 1.1187 | Val Acc: 0.8034 | Val F1: 0.3897
üéâ New best model found! F1-Score: 0.3897. Saved to training_outputs/20250708-135908/best_model.pth
Epoch [043/300] | Duration: 129.44s | Train Loss: 0.9639 | Train Acc: 0.7556 | Val Loss: 1.1187 | Val Acc: 0.7509 | Val F1: 0.3626
Epoch [044/300] | Duration: 138.96s | Train Loss: 0.9972 | Train Acc: 0.7481 | Val Loss: 1.1129 | Val Acc: 0.7828 | Val F1: 0.3791
Epoch [045/300] | Duration: 133.51s | Train Loss: 0.9677 | Train Acc: 0.7659 | Val Loss: 1.1164 | Val Acc: 0.7622 | Val F1: 0.3681
Epoch [046/300] | Duration: 136.64s | Train Loss: 0.9191 | Train Acc: 0.7701 | Val Loss: 1.1129 | Val Acc: 0.7846 | Val F1: 0.3801
Epoch [047/300] | Duration: 138.81s | Train Loss: 0.9922 | Train Acc: 0.7584 | Val Loss: 1.1129 | Val Acc: 0.7884 | Val F1: 0.3824
Epoch [048/300] | Duration: 131.50s | Train Loss: 0.9984 | Train Acc: 0.7575 | Val Loss: 1.1094 | Val Acc: 0.7678 | Val F1: 0.3720
Epoch [049/300] | Duration: 131.51s | Train Loss: 0.9428 | Train Acc: 0.7706 | Val Loss: 1.1120 | Val Acc: 0.7566 | Val F1: 0.3665
Epoch [050/300] | Duration: 135.06s | Train Loss: 0.9654 | Train Acc: 0.7715 | Val Loss: 1.1088 | Val Acc: 0.7772 | Val F1: 0.3768
Epoch [051/300] | Duration: 133.66s | Train Loss: 0.9498 | Train Acc: 0.7683 | Val Loss: 1.1099 | Val Acc: 0.7622 | Val F1: 0.3693
Epoch [052/300] | Duration: 131.58s | Train Loss: 0.9575 | Train Acc: 0.7678 | Val Loss: 1.1053 | Val Acc: 0.7734 | Val F1: 0.3758
Epoch [053/300] | Duration: 129.47s | Train Loss: 0.9461 | Train Acc: 0.7720 | Val Loss: 1.1096 | Val Acc: 0.7397 | Val F1: 0.3576
Epoch [054/300] | Duration: 121.77s | Train Loss: 0.9227 | Train Acc: 0.7711 | Val Loss: 1.1079 | Val Acc: 0.7903 | Val F1: 0.3831
Epoch [055/300] | Duration: 118.65s | Train Loss: 0.9560 | Train Acc: 0.7622 | Val Loss: 1.1001 | Val Acc: 0.7865 | Val F1: 0.3817
Epoch [056/300] | Duration: 117.03s | Train Loss: 0.9374 | Train Acc: 0.7720 | Val Loss: 1.0989 | Val Acc: 0.7790 | Val F1: 0.3784
Epoch [057/300] | Duration: 128.10s | Train Loss: 0.9336 | Train Acc: 0.7729 | Val Loss: 1.0934 | Val Acc: 0.7809 | Val F1: 0.3796
Epoch [058/300] | Duration: 147.59s | Train Loss: 0.9562 | Train Acc: 0.7706 | Val Loss: 1.0931 | Val Acc: 0.7978 | Val F1: 0.3881
Epoch [059/300] | Duration: 139.52s | Train Loss: 0.9371 | Train Acc: 0.7846 | Val Loss: 1.0943 | Val Acc: 0.8071 | Val F1: 0.3918
üéâ New best model found! F1-Score: 0.3918. Saved to training_outputs/20250708-135908/best_model.pth
Epoch [060/300] | Duration: 131.67s | Train Loss: 0.9342 | Train Acc: 0.7823 | Val Loss: 1.0929 | Val Acc: 0.7884 | Val F1: 0.3833
Epoch [061/300] | Duration: 129.60s | Train Loss: 0.9153 | Train Acc: 0.7856 | Val Loss: 1.0946 | Val Acc: 0.7978 | Val F1: 0.3866
Epoch [062/300] | Duration: 139.62s | Train Loss: 0.9279 | Train Acc: 0.7903 | Val Loss: 1.0947 | Val Acc: 0.7828 | Val F1: 0.3809
Epoch [063/300] | Duration: 138.03s | Train Loss: 0.9544 | Train Acc: 0.7898 | Val Loss: 1.0928 | Val Acc: 0.7978 | Val F1: 0.3893
Epoch [064/300] | Duration: 137.56s | Train Loss: 0.9047 | Train Acc: 0.8001 | Val Loss: 1.0909 | Val Acc: 0.8015 | Val F1: 0.3901
Epoch [065/300] | Duration: 140.47s | Train Loss: 0.9287 | Train Acc: 0.7842 | Val Loss: 1.0898 | Val Acc: 0.7640 | Val F1: 0.3700
Epoch [066/300] | Duration: 128.44s | Train Loss: 0.9176 | Train Acc: 0.7996 | Val Loss: 1.0870 | Val Acc: 0.7978 | Val F1: 0.3870
Epoch [067/300] | Duration: 125.55s | Train Loss: 0.9427 | Train Acc: 0.7851 | Val Loss: 1.0814 | Val Acc: 0.7978 | Val F1: 0.3881
Epoch [068/300] | Duration: 135.93s | Train Loss: 0.9479 | Train Acc: 0.7884 | Val Loss: 1.0823 | Val Acc: 0.7715 | Val F1: 0.3743
Epoch [069/300] | Duration: 136.00s | Train Loss: 0.9276 | Train Acc: 0.7692 | Val Loss: 1.0861 | Val Acc: 0.7659 | Val F1: 0.3709
Epoch [070/300] | Duration: 133.07s | Train Loss: 0.9410 | Train Acc: 0.7870 | Val Loss: 1.0808 | Val Acc: 0.8015 | Val F1: 0.3901
Epoch [071/300] | Duration: 135.43s | Train Loss: 0.9236 | Train Acc: 0.7879 | Val Loss: 1.0814 | Val Acc: 0.7809 | Val F1: 0.3793
Epoch [072/300] | Duration: 136.21s | Train Loss: 0.9412 | Train Acc: 0.7865 | Val Loss: 1.0749 | Val Acc: 0.8015 | Val F1: 0.3892
Epoch [073/300] | Duration: 137.17s | Train Loss: 0.9099 | Train Acc: 0.7931 | Val Loss: 1.0815 | Val Acc: 0.7996 | Val F1: 0.3903
Epoch [074/300] | Duration: 140.82s | Train Loss: 0.9028 | Train Acc: 0.7978 | Val Loss: 1.0927 | Val Acc: 0.8146 | Val F1: 0.3977
üéâ New best model found! F1-Score: 0.3977. Saved to training_outputs/20250708-135908/best_model.pth
Epoch [075/300] | Duration: 143.65s | Train Loss: 0.8940 | Train Acc: 0.8043 | Val Loss: 1.0711 | Val Acc: 0.7940 | Val F1: 0.3869
Epoch [076/300] | Duration: 142.93s | Train Loss: 0.9093 | Train Acc: 0.7973 | Val Loss: 1.0763 | Val Acc: 0.7959 | Val F1: 0.3879
Epoch [077/300] | Duration: 141.84s | Train Loss: 0.9289 | Train Acc: 0.7931 | Val Loss: 1.0731 | Val Acc: 0.7903 | Val F1: 0.3845
Epoch [078/300] | Duration: 144.08s | Train Loss: 0.8760 | Train Acc: 0.8034 | Val Loss: 1.0786 | Val Acc: 0.7996 | Val F1: 0.3898
Epoch [079/300] | Duration: 139.75s | Train Loss: 0.9027 | Train Acc: 0.8062 | Val Loss: 1.0735 | Val Acc: 0.7996 | Val F1: 0.3895
Epoch [080/300] | Duration: 139.20s | Train Loss: 0.8940 | Train Acc: 0.8038 | Val Loss: 1.0911 | Val Acc: 0.8071 | Val F1: 0.3931
Epoch [081/300] | Duration: 134.40s | Train Loss: 0.9302 | Train Acc: 0.8015 | Val Loss: 1.0698 | Val Acc: 0.8015 | Val F1: 0.3911
Epoch [082/300] | Duration: 127.85s | Train Loss: 0.9090 | Train Acc: 0.7987 | Val Loss: 1.0730 | Val Acc: 0.7903 | Val F1: 0.3845
Epoch [083/300] | Duration: 122.93s | Train Loss: 0.8932 | Train Acc: 0.8109 | Val Loss: 1.0756 | Val Acc: 0.8052 | Val F1: 0.3932
Epoch [084/300] | Duration: 129.10s | Train Loss: 0.9074 | Train Acc: 0.8001 | Val Loss: 1.0656 | Val Acc: 0.8052 | Val F1: 0.3928
Epoch [085/300] | Duration: 130.33s | Train Loss: 0.8838 | Train Acc: 0.8085 | Val Loss: 1.0627 | Val Acc: 0.8052 | Val F1: 0.3928
srun: Job step aborted: Waiting up to 62 seconds for job step to finish.
slurmstepd: error: *** JOB 4961333 ON workergpu094 CANCELLED AT 2025-07-08T17:17:53 ***
slurmstepd: error: *** STEP 4961333.0 ON workergpu094 CANCELLED AT 2025-07-08T17:17:53 ***
