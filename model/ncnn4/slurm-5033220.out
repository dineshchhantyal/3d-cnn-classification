The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) modules/2.3-20240529   2) openblas/single-0.3.26
üöÄ Starting Run. All outputs will be saved to: training_outputs/20250724-172257
‚öôÔ∏è Using device: cuda
Hyperparameters: {'input_depth': 16, 'input_height': 32, 'input_width': 32, 'num_classes': 3, 'classes_names': ['mitotic', 'new_daughter', 'stable'], 'learning_rate': 1e-05, 'batch_size': 16, 'num_epochs': 300, 'num_input_channels': 4, 'dropout_rate': 0.1, 'weight_decay': 1e-05, 'early_stopping_patience': 35, 'max_samples_per_class': {'mitotic': 221, 'new_daughter': 221, 'stable': 221}, 'class_weights': [1.0, 1.0, 1.0]}

Loading datasets...
Dataset loaded with 660 total samples:
  - mitotic: 218 samples
  - new_daughter: 221 samples
  - stable: 221 samples
  Applied per-class limits:
    - mitotic: 221 max samples
    - new_daughter: 221 max samples
    - stable: 221 max samples
Dataset loaded with 660 total samples:
  - mitotic: 218 samples
  - new_daughter: 221 samples
  - stable: 221 samples
  Applied per-class limits:
    - mitotic: 221 max samples
    - new_daughter: 221 max samples
    - stable: 221 max samples

Training on 528 samples, validating on 132 samples.
Model has 71,379 trainable parameters.

--- Starting Training ---
Epoch [001/300] | Duration: 48.76s | Train Loss: 1.0868 | Train Acc: 0.4186 | Val Loss: 1.0619 | Val Acc: 0.4015 | Val F1: 0.2985
üéâ New best model found! F1-Score: 0.2985. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [002/300] | Duration: 8.86s | Train Loss: 1.0335 | Train Acc: 0.5379 | Val Loss: 0.9930 | Val Acc: 0.6212 | Val F1: 0.5746
üéâ New best model found! F1-Score: 0.5746. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [003/300] | Duration: 7.39s | Train Loss: 0.9850 | Train Acc: 0.6061 | Val Loss: 0.9521 | Val Acc: 0.6818 | Val F1: 0.6586
üéâ New best model found! F1-Score: 0.6586. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [004/300] | Duration: 7.61s | Train Loss: 0.9608 | Train Acc: 0.6269 | Val Loss: 0.9298 | Val Acc: 0.7045 | Val F1: 0.6822
üéâ New best model found! F1-Score: 0.6822. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [005/300] | Duration: 8.08s | Train Loss: 0.9258 | Train Acc: 0.6686 | Val Loss: 0.9076 | Val Acc: 0.7273 | Val F1: 0.7131
üéâ New best model found! F1-Score: 0.7131. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [006/300] | Duration: 7.93s | Train Loss: 0.8978 | Train Acc: 0.6799 | Val Loss: 0.8874 | Val Acc: 0.7273 | Val F1: 0.7129
Epoch [007/300] | Duration: 7.28s | Train Loss: 0.8907 | Train Acc: 0.7045 | Val Loss: 0.8757 | Val Acc: 0.7197 | Val F1: 0.7073
Epoch [008/300] | Duration: 6.86s | Train Loss: 0.8753 | Train Acc: 0.6951 | Val Loss: 0.8577 | Val Acc: 0.7348 | Val F1: 0.7240
üéâ New best model found! F1-Score: 0.7240. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [009/300] | Duration: 6.35s | Train Loss: 0.8593 | Train Acc: 0.7008 | Val Loss: 0.8443 | Val Acc: 0.7500 | Val F1: 0.7440
üéâ New best model found! F1-Score: 0.7440. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [010/300] | Duration: 6.83s | Train Loss: 0.8473 | Train Acc: 0.6913 | Val Loss: 0.8329 | Val Acc: 0.7348 | Val F1: 0.7260
Epoch [011/300] | Duration: 7.46s | Train Loss: 0.8181 | Train Acc: 0.7273 | Val Loss: 0.8169 | Val Acc: 0.7500 | Val F1: 0.7420
Epoch [012/300] | Duration: 7.50s | Train Loss: 0.8410 | Train Acc: 0.6951 | Val Loss: 0.8077 | Val Acc: 0.7576 | Val F1: 0.7506
üéâ New best model found! F1-Score: 0.7506. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [013/300] | Duration: 8.27s | Train Loss: 0.8140 | Train Acc: 0.7235 | Val Loss: 0.8018 | Val Acc: 0.8030 | Val F1: 0.7984
üéâ New best model found! F1-Score: 0.7984. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [014/300] | Duration: 9.06s | Train Loss: 0.8073 | Train Acc: 0.7102 | Val Loss: 0.7929 | Val Acc: 0.7879 | Val F1: 0.7831
Epoch [015/300] | Duration: 7.86s | Train Loss: 0.7902 | Train Acc: 0.7254 | Val Loss: 0.7780 | Val Acc: 0.8030 | Val F1: 0.7981
Epoch [016/300] | Duration: 8.05s | Train Loss: 0.7635 | Train Acc: 0.7481 | Val Loss: 0.7617 | Val Acc: 0.7955 | Val F1: 0.7901
Epoch [017/300] | Duration: 8.38s | Train Loss: 0.7830 | Train Acc: 0.7311 | Val Loss: 0.7598 | Val Acc: 0.7803 | Val F1: 0.7751
Epoch [018/300] | Duration: 7.52s | Train Loss: 0.7680 | Train Acc: 0.7405 | Val Loss: 0.7463 | Val Acc: 0.8030 | Val F1: 0.7984
Epoch [019/300] | Duration: 7.99s | Train Loss: 0.7497 | Train Acc: 0.7367 | Val Loss: 0.7448 | Val Acc: 0.8182 | Val F1: 0.8172
üéâ New best model found! F1-Score: 0.8172. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [020/300] | Duration: 7.49s | Train Loss: 0.7483 | Train Acc: 0.7405 | Val Loss: 0.7311 | Val Acc: 0.7955 | Val F1: 0.7911
Epoch [021/300] | Duration: 7.50s | Train Loss: 0.7446 | Train Acc: 0.7500 | Val Loss: 0.7136 | Val Acc: 0.8106 | Val F1: 0.8074
Epoch [022/300] | Duration: 7.69s | Train Loss: 0.7304 | Train Acc: 0.7614 | Val Loss: 0.7233 | Val Acc: 0.8030 | Val F1: 0.8007
Epoch [023/300] | Duration: 7.72s | Train Loss: 0.7497 | Train Acc: 0.7348 | Val Loss: 0.7041 | Val Acc: 0.8030 | Val F1: 0.8000
Epoch [024/300] | Duration: 7.48s | Train Loss: 0.7184 | Train Acc: 0.7803 | Val Loss: 0.6893 | Val Acc: 0.8106 | Val F1: 0.8076
Epoch [025/300] | Duration: 8.26s | Train Loss: 0.6895 | Train Acc: 0.7841 | Val Loss: 0.6826 | Val Acc: 0.8106 | Val F1: 0.8068
Epoch [026/300] | Duration: 8.70s | Train Loss: 0.6953 | Train Acc: 0.7727 | Val Loss: 0.6677 | Val Acc: 0.8333 | Val F1: 0.8315
üéâ New best model found! F1-Score: 0.8315. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [027/300] | Duration: 7.52s | Train Loss: 0.7064 | Train Acc: 0.7538 | Val Loss: 0.6744 | Val Acc: 0.8106 | Val F1: 0.8058
Epoch [028/300] | Duration: 8.48s | Train Loss: 0.6888 | Train Acc: 0.7765 | Val Loss: 0.6565 | Val Acc: 0.8258 | Val F1: 0.8233
Epoch [029/300] | Duration: 7.88s | Train Loss: 0.6721 | Train Acc: 0.7860 | Val Loss: 0.6427 | Val Acc: 0.8333 | Val F1: 0.8309
Epoch [030/300] | Duration: 7.22s | Train Loss: 0.6875 | Train Acc: 0.7727 | Val Loss: 0.6494 | Val Acc: 0.8182 | Val F1: 0.8158
Epoch [031/300] | Duration: 7.50s | Train Loss: 0.6457 | Train Acc: 0.8030 | Val Loss: 0.6408 | Val Acc: 0.8182 | Val F1: 0.8158
Epoch [032/300] | Duration: 8.28s | Train Loss: 0.6471 | Train Acc: 0.7841 | Val Loss: 0.6258 | Val Acc: 0.8409 | Val F1: 0.8401
üéâ New best model found! F1-Score: 0.8401. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [033/300] | Duration: 8.20s | Train Loss: 0.6586 | Train Acc: 0.7879 | Val Loss: 0.6041 | Val Acc: 0.8333 | Val F1: 0.8309
Epoch [034/300] | Duration: 6.54s | Train Loss: 0.6460 | Train Acc: 0.7803 | Val Loss: 0.6029 | Val Acc: 0.8485 | Val F1: 0.8477
üéâ New best model found! F1-Score: 0.8477. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [035/300] | Duration: 8.08s | Train Loss: 0.6396 | Train Acc: 0.7879 | Val Loss: 0.6067 | Val Acc: 0.8409 | Val F1: 0.8407
Epoch [036/300] | Duration: 7.91s | Train Loss: 0.6481 | Train Acc: 0.8030 | Val Loss: 0.5887 | Val Acc: 0.8485 | Val F1: 0.8466
Epoch [037/300] | Duration: 8.45s | Train Loss: 0.6228 | Train Acc: 0.7917 | Val Loss: 0.5812 | Val Acc: 0.8485 | Val F1: 0.8472
Epoch [038/300] | Duration: 7.83s | Train Loss: 0.6190 | Train Acc: 0.7992 | Val Loss: 0.5690 | Val Acc: 0.8485 | Val F1: 0.8472
Epoch [039/300] | Duration: 6.99s | Train Loss: 0.6381 | Train Acc: 0.7992 | Val Loss: 0.5678 | Val Acc: 0.8561 | Val F1: 0.8559
üéâ New best model found! F1-Score: 0.8559. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [040/300] | Duration: 6.45s | Train Loss: 0.6070 | Train Acc: 0.8295 | Val Loss: 0.5540 | Val Acc: 0.8636 | Val F1: 0.8629
üéâ New best model found! F1-Score: 0.8629. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [041/300] | Duration: 7.95s | Train Loss: 0.5864 | Train Acc: 0.8390 | Val Loss: 0.5496 | Val Acc: 0.8636 | Val F1: 0.8629
Epoch [042/300] | Duration: 7.64s | Train Loss: 0.5912 | Train Acc: 0.8144 | Val Loss: 0.5388 | Val Acc: 0.8485 | Val F1: 0.8466
Epoch [043/300] | Duration: 7.28s | Train Loss: 0.6114 | Train Acc: 0.8049 | Val Loss: 0.5397 | Val Acc: 0.8636 | Val F1: 0.8634
üéâ New best model found! F1-Score: 0.8634. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [044/300] | Duration: 8.91s | Train Loss: 0.6008 | Train Acc: 0.8163 | Val Loss: 0.5341 | Val Acc: 0.8636 | Val F1: 0.8640
üéâ New best model found! F1-Score: 0.8640. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [045/300] | Duration: 9.73s | Train Loss: 0.5937 | Train Acc: 0.7992 | Val Loss: 0.5250 | Val Acc: 0.8485 | Val F1: 0.8466
Epoch [046/300] | Duration: 8.94s | Train Loss: 0.5752 | Train Acc: 0.8125 | Val Loss: 0.5152 | Val Acc: 0.8561 | Val F1: 0.8548
Epoch [047/300] | Duration: 7.02s | Train Loss: 0.5793 | Train Acc: 0.8239 | Val Loss: 0.5156 | Val Acc: 0.8636 | Val F1: 0.8624
Epoch [048/300] | Duration: 7.42s | Train Loss: 0.5568 | Train Acc: 0.8314 | Val Loss: 0.5130 | Val Acc: 0.8561 | Val F1: 0.8548
Epoch [049/300] | Duration: 7.25s | Train Loss: 0.5549 | Train Acc: 0.8163 | Val Loss: 0.5108 | Val Acc: 0.8636 | Val F1: 0.8640
Epoch [050/300] | Duration: 8.02s | Train Loss: 0.5672 | Train Acc: 0.8182 | Val Loss: 0.5019 | Val Acc: 0.8636 | Val F1: 0.8634
Epoch [051/300] | Duration: 7.57s | Train Loss: 0.5364 | Train Acc: 0.8466 | Val Loss: 0.4874 | Val Acc: 0.8636 | Val F1: 0.8633
Epoch [052/300] | Duration: 7.94s | Train Loss: 0.5580 | Train Acc: 0.8106 | Val Loss: 0.4883 | Val Acc: 0.8636 | Val F1: 0.8629
Epoch [053/300] | Duration: 6.83s | Train Loss: 0.5633 | Train Acc: 0.8182 | Val Loss: 0.4883 | Val Acc: 0.8712 | Val F1: 0.8710
üéâ New best model found! F1-Score: 0.8710. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [054/300] | Duration: 7.94s | Train Loss: 0.5399 | Train Acc: 0.8258 | Val Loss: 0.4801 | Val Acc: 0.8636 | Val F1: 0.8628
Epoch [055/300] | Duration: 8.18s | Train Loss: 0.5423 | Train Acc: 0.8277 | Val Loss: 0.4771 | Val Acc: 0.8788 | Val F1: 0.8792
üéâ New best model found! F1-Score: 0.8792. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [056/300] | Duration: 7.81s | Train Loss: 0.5342 | Train Acc: 0.8314 | Val Loss: 0.4761 | Val Acc: 0.8712 | Val F1: 0.8704
Epoch [057/300] | Duration: 8.38s | Train Loss: 0.5487 | Train Acc: 0.8163 | Val Loss: 0.4738 | Val Acc: 0.8636 | Val F1: 0.8628
Epoch [058/300] | Duration: 9.42s | Train Loss: 0.5312 | Train Acc: 0.8239 | Val Loss: 0.4754 | Val Acc: 0.8636 | Val F1: 0.8640
Epoch [059/300] | Duration: 8.07s | Train Loss: 0.5218 | Train Acc: 0.8333 | Val Loss: 0.4574 | Val Acc: 0.8636 | Val F1: 0.8629
Epoch [060/300] | Duration: 7.44s | Train Loss: 0.5395 | Train Acc: 0.8201 | Val Loss: 0.4567 | Val Acc: 0.8788 | Val F1: 0.8792
Epoch [061/300] | Duration: 6.87s | Train Loss: 0.5407 | Train Acc: 0.8277 | Val Loss: 0.4707 | Val Acc: 0.8788 | Val F1: 0.8789
Epoch [062/300] | Duration: 7.30s | Train Loss: 0.5052 | Train Acc: 0.8352 | Val Loss: 0.4574 | Val Acc: 0.8712 | Val F1: 0.8715
Epoch [063/300] | Duration: 7.76s | Train Loss: 0.5237 | Train Acc: 0.8239 | Val Loss: 0.4516 | Val Acc: 0.8864 | Val F1: 0.8868
üéâ New best model found! F1-Score: 0.8868. Saved to training_outputs/20250724-172257/best_model.pth
Epoch [064/300] | Duration: 7.49s | Train Loss: 0.5297 | Train Acc: 0.8163 | Val Loss: 0.4490 | Val Acc: 0.8712 | Val F1: 0.8710
Epoch [065/300] | Duration: 7.71s | Train Loss: 0.5223 | Train Acc: 0.8295 | Val Loss: 0.4507 | Val Acc: 0.8712 | Val F1: 0.8702
Epoch [066/300] | Duration: 8.23s | Train Loss: 0.5044 | Train Acc: 0.8277 | Val Loss: 0.4497 | Val Acc: 0.8712 | Val F1: 0.8706
Epoch [067/300] | Duration: 7.85s | Train Loss: 0.5257 | Train Acc: 0.8201 | Val Loss: 0.4442 | Val Acc: 0.8712 | Val F1: 0.8702
Epoch [068/300] | Duration: 8.57s | Train Loss: 0.5001 | Train Acc: 0.8428 | Val Loss: 0.4436 | Val Acc: 0.8712 | Val F1: 0.8704
Epoch [069/300] | Duration: 8.46s | Train Loss: 0.5049 | Train Acc: 0.8390 | Val Loss: 0.4461 | Val Acc: 0.8712 | Val F1: 0.8700
Epoch [070/300] | Duration: 8.23s | Train Loss: 0.4979 | Train Acc: 0.8428 | Val Loss: 0.4431 | Val Acc: 0.8712 | Val F1: 0.8717
Epoch [071/300] | Duration: 8.68s | Train Loss: 0.5227 | Train Acc: 0.8239 | Val Loss: 0.4474 | Val Acc: 0.8561 | Val F1: 0.8563
Epoch [072/300] | Duration: 7.77s | Train Loss: 0.4790 | Train Acc: 0.8447 | Val Loss: 0.4346 | Val Acc: 0.8636 | Val F1: 0.8627
Epoch [073/300] | Duration: 8.38s | Train Loss: 0.4852 | Train Acc: 0.8542 | Val Loss: 0.4275 | Val Acc: 0.8712 | Val F1: 0.8702
Epoch [074/300] | Duration: 8.92s | Train Loss: 0.5103 | Train Acc: 0.8428 | Val Loss: 0.4274 | Val Acc: 0.8712 | Val F1: 0.8700
Epoch [075/300] | Duration: 9.08s | Train Loss: 0.4884 | Train Acc: 0.8314 | Val Loss: 0.4365 | Val Acc: 0.8712 | Val F1: 0.8705
Epoch [076/300] | Duration: 8.08s | Train Loss: 0.5010 | Train Acc: 0.8352 | Val Loss: 0.4311 | Val Acc: 0.8712 | Val F1: 0.8717
Epoch [077/300] | Duration: 8.67s | Train Loss: 0.5031 | Train Acc: 0.8258 | Val Loss: 0.4253 | Val Acc: 0.8788 | Val F1: 0.8784
Epoch [078/300] | Duration: 8.30s | Train Loss: 0.4826 | Train Acc: 0.8390 | Val Loss: 0.4221 | Val Acc: 0.8712 | Val F1: 0.8717
Epoch [079/300] | Duration: 6.95s | Train Loss: 0.4896 | Train Acc: 0.8277 | Val Loss: 0.4218 | Val Acc: 0.8712 | Val F1: 0.8700
Epoch [080/300] | Duration: 7.74s | Train Loss: 0.5071 | Train Acc: 0.8258 | Val Loss: 0.4180 | Val Acc: 0.8636 | Val F1: 0.8631
Epoch [081/300] | Duration: 7.96s | Train Loss: 0.4924 | Train Acc: 0.8295 | Val Loss: 0.4261 | Val Acc: 0.8788 | Val F1: 0.8782
Epoch [082/300] | Duration: 7.75s | Train Loss: 0.4853 | Train Acc: 0.8352 | Val Loss: 0.4130 | Val Acc: 0.8788 | Val F1: 0.8782
Epoch [083/300] | Duration: 9.08s | Train Loss: 0.4873 | Train Acc: 0.8409 | Val Loss: 0.4155 | Val Acc: 0.8712 | Val F1: 0.8700
Epoch [084/300] | Duration: 8.64s | Train Loss: 0.4697 | Train Acc: 0.8466 | Val Loss: 0.4181 | Val Acc: 0.8788 | Val F1: 0.8787
Epoch [085/300] | Duration: 7.99s | Train Loss: 0.4784 | Train Acc: 0.8371 | Val Loss: 0.4116 | Val Acc: 0.8712 | Val F1: 0.8714
Epoch [086/300] | Duration: 8.07s | Train Loss: 0.4790 | Train Acc: 0.8295 | Val Loss: 0.4157 | Val Acc: 0.8712 | Val F1: 0.8714
Epoch [087/300] | Duration: 7.15s | Train Loss: 0.4859 | Train Acc: 0.8352 | Val Loss: 0.4113 | Val Acc: 0.8712 | Val F1: 0.8714
Epoch [088/300] | Duration: 7.13s | Train Loss: 0.4941 | Train Acc: 0.8144 | Val Loss: 0.4173 | Val Acc: 0.8712 | Val F1: 0.8714
Epoch [089/300] | Duration: 7.03s | Train Loss: 0.4678 | Train Acc: 0.8485 | Val Loss: 0.4127 | Val Acc: 0.8712 | Val F1: 0.8700
Epoch [090/300] | Duration: 7.44s | Train Loss: 0.4807 | Train Acc: 0.8352 | Val Loss: 0.4113 | Val Acc: 0.8712 | Val F1: 0.8714
Epoch [091/300] | Duration: 7.73s | Train Loss: 0.4686 | Train Acc: 0.8352 | Val Loss: 0.4063 | Val Acc: 0.8788 | Val F1: 0.8787
Epoch [092/300] | Duration: 9.12s | Train Loss: 0.4757 | Train Acc: 0.8277 | Val Loss: 0.4042 | Val Acc: 0.8712 | Val F1: 0.8700
Epoch [093/300] | Duration: 9.16s | Train Loss: 0.4566 | Train Acc: 0.8485 | Val Loss: 0.4041 | Val Acc: 0.8636 | Val F1: 0.8636
Epoch [094/300] | Duration: 9.93s | Train Loss: 0.4747 | Train Acc: 0.8258 | Val Loss: 0.4055 | Val Acc: 0.8788 | Val F1: 0.8782
Epoch [095/300] | Duration: 8.84s | Train Loss: 0.4787 | Train Acc: 0.8371 | Val Loss: 0.4081 | Val Acc: 0.8712 | Val F1: 0.8714
Epoch [096/300] | Duration: 8.67s | Train Loss: 0.4439 | Train Acc: 0.8485 | Val Loss: 0.4035 | Val Acc: 0.8636 | Val F1: 0.8631
Epoch [097/300] | Duration: 8.95s | Train Loss: 0.4816 | Train Acc: 0.8428 | Val Loss: 0.4149 | Val Acc: 0.8636 | Val F1: 0.8631
Epoch [098/300] | Duration: 9.54s | Train Loss: 0.4674 | Train Acc: 0.8390 | Val Loss: 0.4075 | Val Acc: 0.8712 | Val F1: 0.8710

üõë Early stopping triggered after 35 epochs with no improvement.

‚úÖ Training finished.

üíæ Saving final artifacts...
Loaded best model from training_outputs/20250724-172257/best_model.pth for final evaluation.
üìà Saved training metrics plot to training_outputs/20250724-172257/training_metrics.png
üìä Saved final confusion matrix to training_outputs/20250724-172257/final_confusion_matrix.png
üìù Saved final classification report to training_outputs/20250724-172257/final_classification_report.txt

‚ú® Run complete.
