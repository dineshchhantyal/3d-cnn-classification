The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) modules/2.3-20240529   2) openblas/single-0.3.26
🚀 Starting Run. All outputs will be saved to: training_outputs/20250730-150716
⚙️ Using device: cuda
Hyperparameters: {'input_depth': 32, 'input_height': 32, 'input_width': 32, 'num_classes': 3, 'classes_names': ['mitotic', 'new_daughter', 'stable'], 'learning_rate': 1e-05, 'batch_size': 16, 'num_epochs': 300, 'num_input_channels': 4, 'dropout_rate': 0.1, 'weight_decay': 1e-05, 'early_stopping_patience': 35, 'max_samples_per_class': {'mitotic': None, 'new_daughter': None, 'stable': None, 'death': None}, 'class_weights': [1.0, 1.0, 1.0], 'output_dir': 'training_outputs'}

Loading datasets...
Dataset loaded with 7753 total samples:
  - mitotic: 218 samples
  - new_daughter: 434 samples
  - stable: 7101 samples
  Applied per-class limits:
    - mitotic: None max samples
    - new_daughter: None max samples
    - stable: None max samples
    - death: None max samples
Dataset loaded with 7753 total samples:
  - mitotic: 218 samples
  - new_daughter: 434 samples
  - stable: 7101 samples
  Applied per-class limits:
    - mitotic: None max samples
    - new_daughter: None max samples
    - stable: None max samples
    - death: None max samples

Training on 6202 samples, validating on 1551 samples.
Model has 71,379 trainable parameters.

--- Starting Training ---
Epoch [001/300] | Duration: 646.43s | Train Loss: 1.1376 | Train Acc: 0.2918 | Val Loss: 1.1636 | Val Acc: 0.2527 | Val F1: 0.2532
🎉 New best model found! F1-Score: 0.2532. Saved to training_outputs/20250730-150716/best_model.pth
Epoch [002/300] | Duration: 110.39s | Train Loss: 1.1020 | Train Acc: 0.4345 | Val Loss: 1.1001 | Val Acc: 0.4339 | Val F1: 0.3381
🎉 New best model found! F1-Score: 0.3381. Saved to training_outputs/20250730-150716/best_model.pth
Epoch [003/300] | Duration: 104.86s | Train Loss: 1.0767 | Train Acc: 0.4977 | Val Loss: 1.0866 | Val Acc: 0.4855 | Val F1: 0.3289
Epoch [004/300] | Duration: 109.92s | Train Loss: 1.0545 | Train Acc: 0.5389 | Val Loss: 1.0631 | Val Acc: 0.5119 | Val F1: 0.3343
Epoch [005/300] | Duration: 98.79s | Train Loss: 1.0353 | Train Acc: 0.5672 | Val Loss: 1.0292 | Val Acc: 0.5822 | Val F1: 0.3684
🎉 New best model found! F1-Score: 0.3684. Saved to training_outputs/20250730-150716/best_model.pth
Epoch [006/300] | Duration: 197.88s | Train Loss: 1.0112 | Train Acc: 0.6121 | Val Loss: 0.9845 | Val Acc: 0.6460 | Val F1: 0.4117
🎉 New best model found! F1-Score: 0.4117. Saved to training_outputs/20250730-150716/best_model.pth
Epoch [007/300] | Duration: 824.83s | Train Loss: 0.9883 | Train Acc: 0.6317 | Val Loss: 0.9991 | Val Acc: 0.6144 | Val F1: 0.3950
Epoch [008/300] | Duration: 741.06s | Train Loss: 0.9647 | Train Acc: 0.6656 | Val Loss: 0.9770 | Val Acc: 0.6622 | Val F1: 0.4210
🎉 New best model found! F1-Score: 0.4210. Saved to training_outputs/20250730-150716/best_model.pth
Epoch [009/300] | Duration: 630.58s | Train Loss: 0.9396 | Train Acc: 0.6901 | Val Loss: 0.9466 | Val Acc: 0.6899 | Val F1: 0.4379
🎉 New best model found! F1-Score: 0.4379. Saved to training_outputs/20250730-150716/best_model.pth
