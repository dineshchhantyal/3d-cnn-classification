The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) modules/2.3-20240529   2) openblas/single-0.3.26
🚀 Starting Run. All outputs will be saved to: training_outputs/20250728-161831
⚙️ Using device: cuda
Hyperparameters: {'input_depth': 32, 'input_height': 32, 'input_width': 32, 'num_classes': 3, 'classes_names': ['mitotic', 'new_daughter', 'stable'], 'learning_rate': 1e-05, 'batch_size': 16, 'num_epochs': 300, 'num_input_channels': 4, 'dropout_rate': 0.1, 'weight_decay': 1e-05, 'early_stopping_patience': 35, 'max_samples_per_class': {'mitotic': 221, 'new_daughter': 221, 'stable': 221}, 'class_weights': [1.0, 1.0, 1.0]}

Loading datasets...
Dataset loaded with 660 total samples:
  - mitotic: 218 samples
  - new_daughter: 221 samples
  - stable: 221 samples
  Applied per-class limits:
    - mitotic: 221 max samples
    - new_daughter: 221 max samples
    - stable: 221 max samples
Dataset loaded with 660 total samples:
  - mitotic: 218 samples
  - new_daughter: 221 samples
  - stable: 221 samples
  Applied per-class limits:
    - mitotic: 221 max samples
    - new_daughter: 221 max samples
    - stable: 221 max samples

Training on 528 samples, validating on 132 samples.
Model has 71,379 trainable parameters.

--- Starting Training ---
Epoch [001/300] | Duration: 47.67s | Train Loss: 1.0585 | Train Acc: 0.4867 | Val Loss: 1.0939 | Val Acc: 0.3409 | Val F1: 0.1824
🎉 New best model found! F1-Score: 0.1824. Saved to training_outputs/20250728-161831/best_model.pth
Epoch [002/300] | Duration: 12.38s | Train Loss: 1.0218 | Train Acc: 0.5284 | Val Loss: 1.0291 | Val Acc: 0.4924 | Val F1: 0.4352
🎉 New best model found! F1-Score: 0.4352. Saved to training_outputs/20250728-161831/best_model.pth
Epoch [003/300] | Duration: 12.90s | Train Loss: 0.9855 | Train Acc: 0.5625 | Val Loss: 0.9793 | Val Acc: 0.6061 | Val F1: 0.6032
🎉 New best model found! F1-Score: 0.6032. Saved to training_outputs/20250728-161831/best_model.pth
Epoch [004/300] | Duration: 12.41s | Train Loss: 0.9546 | Train Acc: 0.6061 | Val Loss: 0.9551 | Val Acc: 0.6136 | Val F1: 0.6113
🎉 New best model found! F1-Score: 0.6113. Saved to training_outputs/20250728-161831/best_model.pth
Epoch [005/300] | Duration: 15.21s | Train Loss: 0.9355 | Train Acc: 0.6288 | Val Loss: 0.9335 | Val Acc: 0.6136 | Val F1: 0.6095
Epoch [006/300] | Duration: 28.83s | Train Loss: 0.9152 | Train Acc: 0.6534 | Val Loss: 0.9196 | Val Acc: 0.6136 | Val F1: 0.6087
Epoch [007/300] | Duration: 13.02s | Train Loss: 0.8874 | Train Acc: 0.6591 | Val Loss: 0.9064 | Val Acc: 0.6136 | Val F1: 0.6079
Epoch [008/300] | Duration: 12.29s | Train Loss: 0.8772 | Train Acc: 0.6610 | Val Loss: 0.8943 | Val Acc: 0.6288 | Val F1: 0.6220
🎉 New best model found! F1-Score: 0.6220. Saved to training_outputs/20250728-161831/best_model.pth
Epoch [009/300] | Duration: 23.81s | Train Loss: 0.8629 | Train Acc: 0.7064 | Val Loss: 0.8822 | Val Acc: 0.6515 | Val F1: 0.6463
🎉 New best model found! F1-Score: 0.6463. Saved to training_outputs/20250728-161831/best_model.pth
Epoch [010/300] | Duration: 22.38s | Train Loss: 0.8441 | Train Acc: 0.6913 | Val Loss: 0.8705 | Val Acc: 0.7045 | Val F1: 0.6979
🎉 New best model found! F1-Score: 0.6979. Saved to training_outputs/20250728-161831/best_model.pth
Epoch [011/300] | Duration: 12.66s | Train Loss: 0.8233 | Train Acc: 0.7064 | Val Loss: 0.8573 | Val Acc: 0.7121 | Val F1: 0.7042
🎉 New best model found! F1-Score: 0.7042. Saved to training_outputs/20250728-161831/best_model.pth
Epoch [012/300] | Duration: 12.79s | Train Loss: 0.8204 | Train Acc: 0.7178 | Val Loss: 0.8565 | Val Acc: 0.7273 | Val F1: 0.7206
🎉 New best model found! F1-Score: 0.7206. Saved to training_outputs/20250728-161831/best_model.pth
Epoch [013/300] | Duration: 13.52s | Train Loss: 0.8123 | Train Acc: 0.7121 | Val Loss: 0.8455 | Val Acc: 0.7045 | Val F1: 0.6977
Epoch [014/300] | Duration: 13.36s | Train Loss: 0.7999 | Train Acc: 0.7121 | Val Loss: 0.8386 | Val Acc: 0.6970 | Val F1: 0.6894
